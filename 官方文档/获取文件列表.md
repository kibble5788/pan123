# 获取文件列表（推荐）接口说明
## 一、接口基础信息
- **API 地址**：GET 域名 + /api/v2/file/list
- **核心说明**：查询指定文件夹下的文件列表，结果包含回收站文件，需通过 `trashed` 字段自行判断过滤；支持全局搜索与分页查询。

## 二、请求参数
### （一）Header 参数
| 名称 | 类型 | 是否必填 | 说明 |
| ---- | ---- | ---- | ---- |
| Authorization | string | 是 | 鉴权 access_token |
| Platform | string | 是 | 固定值：open_platform |

### （二）QueryString 参数
| 名称 | 类型 | 是否必填 | 说明 |
| ---- | ---- | ---- | ---- |
| parentFileId | number | 是 | 文件夹 ID，查询根目录时填写 0 |
| limit | number | 是 | 每页文件数量，最大值不超过 100 |
| searchData | string | 否 | 搜索关键字，填写后将无视 `parentFileId` 参数，进行全局查找 |
| searchMode | number | 否 | 搜索模式：0-全文模糊搜索（分词匹配相似结果），1-精准搜索（需提供完整文件名） |
| lastFileId | number | 否 | 翻页查询标识，下一页查询时填写上一页响应返回的 `lastFileId` |

## 三、请求示例（参考格式）
### Curl 示例（模板）
```curl
curl --location 'https://open-api.123pan.com/api/v2/file/list?parentFileId=0&limit=20&searchData=测试文件&searchMode=0' \
--header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5c...(过长省略)' \
--header 'Platform: open_platform'
```

### 其他语言示例
支持 Java - OkHttp、JavaScript - jQuery、NodeJs - Axios、Python - http.client 等语言，具体实现可参考官方完整文档。

## 四、返回数据
### （一）整体结构
| 名称 | 类型 | 是否必填 | 说明 |
| ---- | ---- | ---- | ---- |
| lastFileId | number | 是 | 分页标识：-1 表示最后一页（无需继续翻页）；其他数值为下一页查询的起始文件 ID |
| fileList | array | 是 | 文件列表数组，每个元素为单个文件/文件夹的基础信息 |

### （二）fileList 成员结构
| 名称 | 类型 | 是否必填 | 说明 |
| ---- | ---- | ---- | ---- |
| fileId | number | 是 | 文件/文件夹唯一 ID |
| filename | string | 是 | 文件名/文件夹名 |
| type | number | 是 | 类型标识：0-文件，1-文件夹 |
| size | number | 是 | 文件大小（单位：byte）；文件夹返回其包含文件总大小 |
| etag | string | 是 | 文件 MD5 值 |
| status | number | 是 | 文件审核状态：大于 100 表示审核驳回 |
| parentFileId | number | 是 | 父目录 ID |
| category | number | 是 | 文件分类：0-未知，1-音频，2-视频，3-图片 |
| trashed | int | 是 | 是否在回收站：0-否，1-是 |

## 五、响应示例（参考格式）
```json
{
"code": 0,
"message": "ok",
"data": {
"lastFileId": 14750010,
"fileList": [
{
"fileId": 14749954,
"filename": "Keyshot_win64_2024.exe",
"type": 0,
"size": 1163176272,
"etag": "ab6dd0cfca2da20f84f55d2ed73a8c3d",
"status": 2,
"parentFileId": 14749926,
"category": 0,
"trashed": 0
},
{
"fileId": 14749988,
"filename": "风景图.jpg",
"type": 0,
"size": 204800,
"etag": "789abcdef1234567890abcdef12345678",
"status": 2,
"parentFileId": 0,
"category": 3,
"trashed": 0
},
{
"fileId": 14750000,
"filename": "旧文档.txt",
"type": 0,
"size": 1024,
"etag": "1234567890abcdef1234567890abcdef",
"status": 2,
"parentFileId": 0,
"category": 0,
"trashed": 1
}
]
},
"x-traceID": "12345678-90ab-cdef-1234-567890abcdef_kong-db-5898fdd8c6-t5pvc"
}
```

## 补充说明
- 响应中 `code: 0` 表示接口请求成功，若 `lastFileId = -1`，说明已查询到所有文件，无需继续分页。
- 全局搜索逻辑：填写 `searchData` 后，`parentFileId` 失效，将在所有文件（含回收站）中搜索，`searchMode` 需与搜索需求匹配（模糊搜索/精准搜索）。
- 回收站文件过滤：需在业务逻辑中判断 `trashed` 字段，若需排除回收站文件，筛选 `trashed = 0` 的数据即可。
- 分页注意事项：每页最大查询数量为 100，超过则按 100 条返回；下一页查询需携带上一页的 `lastFileId` 作为参数。
- 若 `parentFileId` 对应的文件夹不存在或无访问权限，接口会返回对应错误提示，具体信息可查看 `message` 字段。